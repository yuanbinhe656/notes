在 C++11 中提供了专门的类型转换函数，程序猿可以非常方便的使用它们进行数值类型和字符串类型之间的转换。

# 1\. 数值转换为字符串

使用 `to_string()` 方法可以非常方便地将各种数值类型转换为字符串类型，这是一个重载函，函数声明位于头文件 `<string>` 中，函数原型如下：

c++

<table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 头文件 &lt;string&gt;</span></span><br><span class="line"><span class="function">string <span class="title">to_string</span> <span class="params">(<span class="type">int</span> val)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">to_string</span> <span class="params">(<span class="type">long</span> val)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">to_string</span> <span class="params">(<span class="type">long</span> <span class="type">long</span> val)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">to_string</span> <span class="params">(<span class="type">unsigned</span> val)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">to_string</span> <span class="params">(<span class="type">unsigned</span> <span class="type">long</span> val)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">to_string</span> <span class="params">(<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> val)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">to_string</span> <span class="params">(<span class="type">float</span> val)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">to_string</span> <span class="params">(<span class="type">double</span> val)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">to_string</span> <span class="params">(<span class="type">long</span> <span class="type">double</span> val)</span></span>;</span><br></pre></td></tr></tbody></table>

关于函数的使用是非常简单的，示例代码如下：

c++

<table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    string pi = <span class="string">"pi is "</span> + <span class="built_in">to_string</span>(<span class="number">3.1415926</span>);</span><br><span class="line">    string love = <span class="string">"love is "</span> + <span class="built_in">to_string</span>(<span class="number">5.20</span> + <span class="number">13.14</span>);</span><br><span class="line">    cout &lt;&lt; pi &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; love &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table>

# 2\. 字符串转换为数值

由于 C++ 中的数值类型包括`整形`和`浮点型`，因此针对于不同的类型提供了不同的函数，通过调用这些函数可以将字符串类型转换为对应的数值类型。

c++

<table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义于头文件 &lt;string&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span>       <span class="title">stoi</span><span class="params">( <span class="type">const</span> std::string&amp; str, std::<span class="type">size_t</span>* pos = <span class="number">0</span>, <span class="type">int</span> base = <span class="number">10</span> )</span></span>;</span><br><span class="line"><span class="function"><span class="type">long</span>      <span class="title">stol</span><span class="params">( <span class="type">const</span> std::string&amp; str, std::<span class="type">size_t</span>* pos = <span class="number">0</span>, <span class="type">int</span> base = <span class="number">10</span> )</span></span>;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">stoll</span><span class="params">( <span class="type">const</span> std::string&amp; str, std::<span class="type">size_t</span>* pos = <span class="number">0</span>, <span class="type">int</span> base = <span class="number">10</span> )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">long</span>      <span class="title">stoul</span><span class="params">( <span class="type">const</span> std::string&amp; str, std::<span class="type">size_t</span>* pos = <span class="number">0</span>, <span class="type">int</span> base = <span class="number">10</span> )</span></span>;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="title">stoull</span><span class="params">( <span class="type">const</span> std::string&amp; str, std::<span class="type">size_t</span>* pos = <span class="number">0</span>, <span class="type">int</span> base = <span class="number">10</span> )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">float</span>       <span class="title">stof</span><span class="params">( <span class="type">const</span> std::string&amp; str, std::<span class="type">size_t</span>* pos = <span class="number">0</span> )</span></span>;</span><br><span class="line"><span class="function"><span class="type">double</span>      <span class="title">stod</span><span class="params">( <span class="type">const</span> std::string&amp; str, std::<span class="type">size_t</span>* pos = <span class="number">0</span> )</span></span>;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">double</span> <span class="title">stold</span><span class="params">( <span class="type">const</span> std::string&amp; str, std::<span class="type">size_t</span>* pos = <span class="number">0</span> )</span></span>;</span><br></pre></td></tr></tbody></table>

- `str`：要转换的字符串
- `pos`：传出参数，记录从哪个字符开始无法继续进行解析，比如: 123`a`bc, 传出的位置为 3
- `base`：若 base 为 0 ，则自动检测数值进制：若前缀为 `0` ，则为八进制，若前缀为 `0x` 或 `0X`，则为十六进制，否则为十进制。

这些函数虽然都有多个参数，但是除去第一个参数外其他都有默认值，一般情况下使用默认值就能满足需求。关于函数的使用也给大家提供了一个例子，示例代码如下：

c++

<table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    string str1 = <span class="string">"45"</span>;</span><br><span class="line">    string str2 = <span class="string">"3.14159"</span>;</span><br><span class="line">    string str3 = <span class="string">"9527 with words"</span>;</span><br><span class="line">    string str4 = <span class="string">"words and 2"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> myint1 = std::<span class="built_in">stoi</span>(str1);</span><br><span class="line">    <span class="type">float</span> myint2 = std::<span class="built_in">stof</span>(str2);</span><br><span class="line">    <span class="type">int</span> myint3 = std::<span class="built_in">stoi</span>(str3);</span><br><span class="line">    <span class="comment">// 错误： 'std::invalid_argument'</span></span><br><span class="line">    <span class="comment">// int myint4 = std::stoi(str4);</span></span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">"std::stoi(\""</span> &lt;&lt; str1 &lt;&lt; <span class="string">"\") is "</span> &lt;&lt; myint1 &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">"std::stof(\""</span> &lt;&lt; str2 &lt;&lt; <span class="string">"\") is "</span> &lt;&lt; myint2 &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">"std::stoi(\""</span> &lt;&lt; str3 &lt;&lt; <span class="string">"\") is "</span> &lt;&lt; myint3 &lt;&lt; endl;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; "std::stoi(\"" &lt;&lt; str4 &lt;&lt; "\") is " &lt;&lt; myint4 &lt;&lt; endl;</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table>

示例代码输入的结果如下：

c++

<table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">std::<span class="built_in">stoi</span>(<span class="string">"45"</span>) is <span class="number">45</span></span><br><span class="line">std::<span class="built_in">stof</span>(<span class="string">"3.14159"</span>) is <span class="number">3.14159</span></span><br><span class="line">std::<span class="built_in">stoi</span>(<span class="string">"9527 with words"</span>) is <span class="number">9527</span></span><br></pre></td></tr></tbody></table>

从上述测试程序可以得出这样的结论，在 C++11 提供的这些转换函数将字符串转换为数值的过程中：==只有字符串前一部分有数字才能成功转化==

- **`如果字符串中所有字符都是数值类型，整个字符串会被转换为对应的数值，并通过返回值返回`**
- **`如果字符串的前半部分字符是数值类型，后半部不是，那么前半部分会被转换为对应的数值，并通过返回值返回`**
- **`如果字符第一个字符不是数值类型转换失败`**